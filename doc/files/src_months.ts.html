<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\months.ts - Event Calendar</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png" width="117" height="52">Event Calendar: src\months.ts</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Modules</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../modules/Calendar.html">Calendar</a>
                            </li>
                    </ul>
                </div>
            </div>
            
            <div id="classes" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Classes</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../classes/Dialog.html">Dialog</a></li>
                            <li><a href="../classes/EventCalendar.html">EventCalendar</a></li>
                            <li><a href="../classes/Events.html">Events</a></li>
                            <li><a href="../classes/Header.html">Header</a></li>
                            <li><a href="../classes/Helpers.html">Helpers</a></li>
                            <li><a href="../classes/ModalTemplate.html">ModalTemplate</a></li>
                            <li><a href="../classes/MonthCalendar.html">MonthCalendar</a></li>
                            <li><a href="../classes/MoveAction.html">MoveAction</a></li>
                            <li><a href="../classes/Popover.html">Popover</a></li>
                            <li><a href="../classes/PostDataAction.html">PostDataAction</a></li>
                    </ul>
                </div>
            </div>
            
            
            
            
            
            <div id="fileTree" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Files</h2>
                </div>
                <div class="bd">
                    <ul><li>src\actions.ts/<ul></ul></li><li>src\calendar.ts/<ul></ul></li><li>src\events.ts/<ul></ul></li><li>src\header.ts/<ul></ul></li><li>src\helpers.ts/<ul></ul></li><li>src\modal.ts/<ul></ul></li><li>src\months.ts/<ul></ul></li><li>src\popover.ts/<ul></ul></li></ul>
                </div>
            </div>
            
        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>src\months.ts</h4>

<pre class="code prettyprint linenums">
///&lt;reference path=&quot;../typing/jquery.d.ts&quot; /&gt;
///&lt;reference path=&quot;../typing/moment.d.ts&quot; /&gt;
///&lt;reference path=&quot;common.ts&quot; /&gt;
///&lt;reference path=&quot;helpers.ts&quot; /&gt;

module Calendar {

    /**
     * Provides rendering month calendars, marks specified events by
     * custom colors, displays tooltip for each event both personal and
     * to other users. Sets Monday as the first day of week.
     *
     * @class MonthCalendar
     * @constructor
     * @param {ISettings} settings - Plugin settings
     * @param {number} year - Actual year of calendar
     */
    export class MonthCalendar {
        /**
         * Month calendars DOM element.
         *
         * @property element
         * @type {JQuery}
         */
        element: JQuery;

        /**
         * Plugin settings.
         *
         * @property settings
         * @type {ISettings}
         */
        settings: ISettings;

        /**
         * Selected year.
         *
         * @property year
         * @type {number}
         */
        year: number;

        /**
         * Javascript Date object represents current date.
         *
         * @property today
         * @type {Date}
         */
        today: Date = new Date();

        /**
         * Array of month names.
         *
         *     [&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;,
         *     &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;,
         *     &quot;October&quot;, &quot;November&quot;, &quot;December&quot;]
         *
         * @property months
         * @type {Array&lt;string&gt;}
         */
        months: Array&lt;string&gt;;

        /**
         * Array of weekdays shortcuts.
         *
         *     [&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;]
         *
         * @property weekdays
         * @type {Array&lt;string&gt;}
         */
        weekdays: Array&lt;string&gt;;

        constructor(settings: ISettings, year: number) {
            this.settings = settings;
            this.year = year;
            this.months = moment.months();
            this.weekdays = moment.weekdaysShort();
            // set Monday as first day of week
            var sunday = this.weekdays[0];
            this.weekdays.shift();
            this.weekdays.push(sunday);
            // capitalize first letter
            this.capitalize();

            this.element = this.templateCalendar();
        }

        /**
         * Capitalizes the first letter of the month and weekdays names.
         *
         * @method capitalize
         */
        capitalize(): void {
            this.months = this.months.map(item =&gt; Calendar.Helpers.CapitalizeFirstLetter(item));
            this.weekdays = this.weekdays.map(item =&gt; Calendar.Helpers.CapitalizeFirstLetter(item));
        }

        /**
         * Creates wrapper for month tables.
         *
         * @method templateCalendar
         * @return {JQuery} - Calendar for each month
         */
        templateCalendar(): JQuery {
            var view = $(&quot;&lt;div /&gt;&quot;).addClass(&quot;row&quot;);
            for(var i = 0, length = this.months.length; i &lt; length; i++) {
                var monthElement = $(&quot;&lt;div /&gt;&quot;).addClass(&quot;col-md-3 col-sm-4&quot;);
                monthElement
                    .append(this.templateTable(i))
                    .appendTo(view);
            }
            return view;
        }

        /**
         * Creates table for month represented by month index,
         * marks weekdays and events.
         *
         * @method templateTable
         * @param {number} monthId - Month index 0 - 11
         * @return {JQuery} - Month calendar
         */
        templateTable(monthId: number): JQuery {
            var actualDate = new Date(this.year, monthId), // first day in month
                weekDay = (actualDate.getDay() + 6) % 7,    // Monday is start of week
                daysInMonth = moment(actualDate).daysInMonth(), // number of days in month
                displayDay = daysInMonth == 0;              // set display first day in calendar if it is Monday

            // table
            var table = $(&quot;&lt;table /&gt;&quot;)
                .addClass(&quot;calendar-table table-bordered&quot;)
                .append($(&quot;&lt;thead /&gt;&quot;)
                    .append($(&quot;&lt;tr /&gt;&quot;)
                        .addClass(&quot;calendar-header-month&quot;)
                        .append($(&quot;&lt;th /&gt;&quot;)
                            .attr(&quot;colSpan&quot;, 7)
                            .text(this.months[monthId])))
                    .append($(&quot;&lt;tr /&gt;&quot;)
                        .addClass(&quot;calendar-header-day&quot;)))
                .append($(&quot;&lt;tbody /&gt;&quot;)
                    .addClass(&quot;calendar-body&quot;));

            // header
            var dayRow = table.find(&quot;.calendar-header-day&quot;);
            this.weekdays.forEach((item) =&gt; dayRow.append($(&quot;&lt;th /&gt;&quot;).text(item)));

            // body
            var calendarBody = table.find(&quot;.calendar-body&quot;);
            var index = 1;
            for(var i = 0; i &lt; 6; i++) {
                var row = $(&quot;&lt;tr /&gt;&quot;);
                for(var j = 0; j &lt; 7; j++) {
                    var cell = $(&quot;&lt;td /&gt;&quot;).addClass(&quot;cell&quot;);
                    if(i === 0 &amp;&amp; j &gt;= weekDay) {
                        displayDay = true;
                    }

                    if(displayDay) {
                        var cellDate = new Date(this.year, monthId, index),
                            cellDateIndex = cellDate.getDay();
                        // set weekend
                        if(cellDateIndex === 6 || cellDateIndex === 0) {
                            cell.addClass(&quot;weekend&quot;);
                        }
                        // set today
                        if(moment(cellDate).format(&quot;YYYY-MM-DD&quot;) === moment(this.today).format(&quot;YYYY-MM-DD&quot;)) {
                            cell.addClass(&quot;css-today&quot;).addClass(&quot;today&quot;);
                        }

                        // set date number
                        cell.attr(&quot;data-year-day&quot;, moment(cellDate).dayOfYear()).text(index);
                        // resolve month index
                        if (index &lt; daysInMonth) {
                            index++;
                        } else {
                            index = 1;
                            displayDay = false;
                        }
                    }
                    row.append(cell);
                }
                calendarBody.append(row);
            }
            return table;
        }
    }
}
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
